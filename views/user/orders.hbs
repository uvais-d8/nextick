<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description"
		content="Responsive Bootstrap4 Shop Template, Created by Imran Hossain from https://imransdesign.com/">

	<!-- title -->
	<title>Orders</title>

	<!-- favicon -->
	<link rel="shortcut icon" type="image/png" href="/assets/img/favicon.png">
	<!-- google font -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Poppins:400,700&display=swap" rel="stylesheet">
	<!-- fontawesome -->
	<link rel="stylesheet" href="/assets/css/all.min.css">
	<!-- bootstrap -->
	<link rel="stylesheet" href="/assets/bootstrap/css/bootstrap.min.css">
	<!-- owl carousel -->
	<link rel="stylesheet" href="/assets/css/owl.carousel.css">
	<!-- magnific popup -->
	<link rel="stylesheet" href="/assets/css/magnific-popup.css">
	<!-- animate css -->
	<link rel="stylesheet" href="/assets/css/animate.css">
	<!-- mean menu css -->
	<link rel="stylesheet" href="/assets/css/meanmenu.min.css">
	<!-- main style -->
	<link rel="stylesheet" href="/assets/css/main.css">
	<!-- responsive -->
	<link rel="stylesheet" href="/assets/css/responsive.css">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">


	<style>
		.modal-header {
			background-color: #f5a623;
			color: white;
		}

		.modal-footer .btn-secondary {
			background-color: #e0e0e0;
		}

		.modal-footer .btn-danger {
			background-color: #e74c3c;
		}

		:root {
			--primary-color: #4a90e2;
			--secondary-color: #f5a623;
			--background-color: #f9f9f9;
			--text-color: #333;
			--border-color: #e0e0e0;
		}

		.but {
			color: #000000e4;
			background-color: rgba(215, 215, 215, 0.87);
			border-width: 0px;
			font-size: 13px;
			width: 100px;
			height: 45px;
			border-radius: 4px;
			font-weight: 500;

		}

		.but:hover {
			background-color: #c27f11;
			border-radius: 5px;
			color: white,
				font-color: rgb(255, 145, 0);

		}

		.butt {
			font-size: 14px;
			width: 100px;
			height: 50px;
			border-radius: 5px;
			font-weight: bold;
			color: rgb(234, 232, 232);
		}

		.butt:hover {
			font-size: 17px;
			border-radius: 5px;
			font-color: rgb(255, 136, 0);

		}

		body {
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			line-height: 1.6;
			color: var(--text-color);
			background-color: var(--background-color);
			margin: 0;
			padding: 0;
		}

		.container {
			max-width: 1200px;
			margin: 0 auto;
			padding: 0 20px;
		}

		header {
			background-color: #fff;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			position: sticky;
			top: 0;
			z-index: 1000;
		}

		nav {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 1rem 0;
		}

		.logo {
			font-size: 1.5rem;
			font-weight: bold;
			color: var(--primary-color);
			text-decoration: none;
		}

		.nav-links {
			display: flex;
			gap: 1rem;
		}

		.nav-links a {
			color: var(--text-color);
			text-decoration: none;
			transition: color 0.3s ease;
		}

		.nav-links a:hover {
			color: var(--primary-color);
		}

		main {
			padding: 2rem 0;
		}

		.profile-header {
			display: flex;
			align-items: center;
			gap: 2rem;
			margin-bottom: 2rem;
		}

		.profile-avatar {
			width: 150px;
			height: 150px;
			border-radius: 50%;
			object-fit: cover;
			border: 4px solid var(--primary-color);
		}

		.profile-info h1 {
			margin: 0 0 0.5rem 0;
		}

		.profile-info p {
			margin: 0;
			color: #666;
		}

		.section {
			background-color: #fff;
			border-radius: 8px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			padding: 2rem;
			margin-bottom: 2rem;
		}

		.section h2 {
			border-bottom: 2px solid var(--border-color);
			padding-bottom: 0.5rem;
			margin-bottom: 1rem;
		}

		.order-history {
			display: grid;
			gap: 1rem;
		}

		.order {
			border: 1px solid var(--border-color);
			border-radius: 4px;
			padding: 1rem;
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		.order-details {
			flex-grow: 1;
		}

		.order-status {
			font-weight: bold;
			color: var(--secondary-color);
		}

		.account-settings form {
			display: grid;
			gap: 1rem;
		}

		.form-group {
			display: flex;
			flex-direction: column;
		}

		.form-group label {
			margin-bottom: 0.5rem;
		}

		.form-group input {
			padding: 0.5rem;
			border: 1px solid var(--border-color);
			border-radius: 4px;
		}

		footer {
			background-color: #333;
			color: #fff;
			text-align: center;
			padding: 1rem 0;
		}

		@media (max-width: 768px) {
			.profile-header {
				flex-direction: column;
				text-align: center;
			}

			.order {
				flex-direction: column;
				align-items: flex-start;
			}

		}

		.top-header-area .main-menu a {
			color: white;
		}

		main {
			padding: 2rem 0;
		}

		.order-history {
			background-color: white;
			border-radius: 8px;
			padding: 2rem;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		}

		.order {
			display: flex;
			justify-content: space-between;
			padding: 1rem;
			margin-bottom: 1rem;
			border: 1px solid #e0e0e0;
			border-radius: 5px;
			background-color: #fff;
		}

		.order img {
			max-width: 100px;
			height: auto;
		}

		.order-details {
			flex-grow: 1;
		}

		.order-status {
			font-weight: bold;
			color: #f5a623;
		}

		.order-actions button {
			background-color: #e7a83c;
			color: white;
			border: none;
			padding: 0.5rem 1rem;
			border-radius: 5px;
			cursor: pointer;
			width: 110px;
		}

		.order-actions button:hover {
			background-color: #c0872b;
		}

		.order-remove button {
			background-color: #f39c12;
			border-radius: 5px;
			padding: 0.5rem 1rem;
			cursor: pointer;
		}

		.order-remove button:hover {
			background-color: #db7217;
		}

		.gradient-button-blue {
			color: rgb(37, 53, 226);
			font-weight: bold;
			font-size: 15px;
		}

		.gradient-button-green {
			color: rgb(0, 255, 4);
			font-weight: bold;
			font-size: 15px;
		}

		.gradient-button-yellow {
			color: rgb(236, 199, 14);
			font-weight: bold;
			font-size: 15px;
		}

		.gradient-button-purple {
			color: rgb(229, 42, 235);
			font-weight: bold;
			font-size: 15px;

		}

		.gradient-button-red {
			color: rgb(236, 14, 14);
			font-weight: bold;
			font-size: 15px;
		}
	</style>
</head>

<body>

	<!--PreLoader-->
	<div class="loader">
		<div class="loader-inner">
			<div class="circle"></div>
		</div>
	</div>
	<!--PreLoader Ends-->

	<!-- header -->
	<div class="top-header-area" id="sticker">
		<div class="container">
			<div class="row">
				<div class="col-lg-12 col-sm-12 text-center">
					<div class="main-menu-wrap">
						<!-- logo -->
						<div class="site-logo">
							<a href="/">
								<h4 style="font-weight: bold; color:white">WATCH PREMIUM</h4>
							</a>
						</div>
						<!-- logo -->

						<!-- menu start -->
						<nav class="main-menu">
							<ul>
								<li><a href="/">Home</a>
								</li>
								<li><a href="/about">About</a></li>
								<li><a href="/products">Products</a></li>

								<ul class="sub-menu">
									<li><a href="/news.hbs">News</a></li>
									<li><a href="/single-news.hbs">Single News</a></li>
								</ul>
								</li>
								<li><a href="/contact">Contact</a></li>

								<ul class="sub-menu">
									<li>
										<form class="a" method="get" action="/shop">Shop</form>
									</li>
									<li><a href="/checkout.hbs">Check Out</a></li>
									<li><a href="/single-product.hbs">Single Product</a></li>
									<li><a href="/cart.hbs">Cart</a></li>
								</ul>
								</li>
								<li>
									<form method="post" action="/logout">
										<button class="a" type="submit"
											style="color:white; background: none; border: none;cursor: pointer; font-weight:bold">Log
											Out
										</button>
									</form>
								</li>
								<li>
									<div class="header-icons">
										<a href="/wishlist" class="love-icon">
											<i class="fas fa-heart"></i>
										</a>
										<a class="shopping-cart" href="/cart"><i class="fas fa-shopping-cart"></i></a>

										<a style="color: orange;" class="mobile-hide search-bar-icon" href="/profile"><i
												class="fas fa-user"></i></a>
									</div>
								</li>
							</ul>
						</nav>
						<a class="mobile-show search-bar-icon" href="#"><i class="fas fa-search"></i></a>
						<div class="mobile-menu"></div>
						<!-- menu end -->
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end header -->

	<!-- search area -->
	<div class="search-area">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<span class="close-btn"><i class="fas fa-window-close"></i></span>
					<div class="search-bar">
						<div class="search-bar-tablecell">
							<h3>Search For:</h3>
							<input type="text" placeholder="Keywords">
							<button type="submit">Search <i class="fas fa-search"></i></button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end search arewa -->

	<!-- breadcrumb-section -->
	<div class="breadcrumb-section breadcrumb-bg">
		<div class="container">
			<div class="row">
				<div class="col-lg-8 offset-lg-2 text-center">
					<div class="breadcrumb-text">
						<p>We sale quality Items Only</p>
						<h1>Your Orders</h1>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end breadcrumb section -->
	<!-- Modal for Confirmation -->
	<div class="modal fade" id="cancelModal" tabindex="-1" role="dialog" aria-labelledby="cancelModalLabel"
		aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="cancelModalLabel">Confirm Cancellation</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<p id="modalMessage"></p>
					<h4>Are you sure you want to cancel this order?</h4>
					<p>Once canceled, the order cannot be restored. Please confirm if you want to proceed with the
						cancellation.</p>
					<p id="errorMessage" style="color: red; display: none;">An error occurred. Please try again.</p>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-warning" data-dismiss="modal">Close</button>
					<button type="button" class="btn btn-danger" id="confirmCancelBtn">Yes, Cancel</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Orders History Section -->
	<main style="background-color: rgba(240, 237, 237, 0.523);" class="section order-history">
		<h1 style="margin-left: 10%;">Orders History</h1>
		{{#each orders}}
		{{#each items}}
		<div>
			<div style="width: 1200px;margin-left:10%;background-color:white;margin-top:-20px;border-color:rgba(222, 222, 220, 0.715);border-radius:3px"
				class="order">
				<div class="order-details">
					<div class="client-avatar">
						<img src="/{{this.productId.images.[0]}}" alt="{{this.productId.name}}" />
					</div>
					<h4>{{this.productId.name}}</h4>
					<p>Price:
						{{#if this.priceWithDiscount}}
						{{#if (eq this.priceWithDiscount this.productId.price)}}
						<b>₹{{this.productId.price}}</b>
						{{else}}
						<del style="color: red;">₹{{this.productId.price}}</del>
						<b>₹{{this.priceWithDiscount}}</b>
						{{/if}}
						{{else}}
						₹{{this.productId.price}}
						{{/if}}
					</p>


					<p style="margin-top: -10px;">Quantity: <b>{{this.quantity}}</b></p>

					<p style="margin-top: -10px;">Total:
						{{#if this.priceWithDiscount}}
						<b>₹ {{multiply this.priceWithDiscount this.quantity}}</b>
						{{else}}
						<b>₹ {{multiply this.orderTotal this.quantity}}</b>
						{{/if}}
					</p>

					<p style="color: rgb(48, 47, 47);margin-top: -10px;">Order Date: <b>{{formatDate ../time}}</b></p>

					<div class="order-actions">
						{{#if (eq this.status "delivered")}}
						<div>
							<button class="btn btn-danger return-button" data-toggle="modal" data-target="#returnModal"
								style="margin-left: 100%; margin-right: auto; display: block; padding: 10px 20px; border-radius: 5px;">
								Return
							</button>
						</div>

						{{!-- {{else if (eq this.status "payment-pending")}}
						<div style="margin-left: 200px;"><button class="btn btn-warning retry-button" id="payButton"
								data-order-id="{{this._id}}"
								style="margin-left: 100%; font-size: 11px; margin-right: auto; display: block; padding: 10px 20px; border-radius: 5px;">
								Retry Payment
							</button>
						</div> --}}

						{{else if (eq this.status "canceled")}}

						{{else if (eq this.status "returned")}}

						{{else}}
						<div> <button class="btn btn-danger"
								style="color: rgba(0, 0, 0, 0.884); height: 35px; margin-left: 100%; margin-top: -150px"
								data-toggle="modal" data-target="#cancelModal"
								onclick="setItemToCancel('{{../_id}}', '{{this._id}}', 'item')">
								Cancel Item
							</button></div>
						{{/if}}
					</div>
					<form style="margin-top: -10px;" method="get" action="/viewDetails/{{../_id}}/{{this._id}}">
						<button class="but" type="submit"
							style="color:rgba(26, 26, 26, 0.898);font-size:13px;height: 30px;border-width:0px;margin-left:100.5%;margin-top:0px;margin-left: 1px;width:130px">view
							more Details</button>
					</form>
				</div>

				<div>
					<p style="margin-top: -20px;">Status:
						<span class="
        {{#if (eq status 'scheduled')}}gradient-button-blue{{else}}
        {{#if (eq status 'pending')}}gradient-button-yellow{{else}}
        {{#if (eq status 'canceled')}}gradient-button-red{{else}}
        {{#if (eq status 'returned')}}gradient-button-yellow{{else}}
		{{#if (eq status 'payment-pending')}}gradient-button-red{{else}}
        {{#if (eq status 'delivered')}}gradient-button-green{{else}}
        {{#if (eq status 'shipped')}}gradient-button-purple{{/if}}{{/if}}
        {{/if}}{{/if}}{{/if}}{{/if}}{{/if}}">
							{{status}}
						</span>
					</p>
				</div>
			</div>

			{{/each}}
		</div>

		<!-- Order Total -->
		<div style="width: 1200px; margin-left: 10%;display: flex;margin-top:-28px">
			<div style="background-color: white; width: 100%; padding: 15px;">
				<h4>Order Total: ₹{{orderTotal}}</h4>
				<p>
					delivery change : ₹ 50
				</p>
			</div>



			<div style="background-color: white;  padding: 10px; text-align: right;display:flex">

				{{!-- <div>
					<form method="get" style="margin-right:100px;width:108px;font-size:13px"
						action="/ordertracking/{{_id}}">
						<button class=" btn btn-warning" type="submit">Retry Payment</button>
					</form>
				</div> --}}
				<div>
					<form method="get" style="margin-left: -350px;margin-right:5px" action="/ordertracking/{{_id}}">
						<button class=" btn btn-warning" type="submit">View Order</button>
					</form>
				</div>
				<div>
					<button style="margin-right:5px;width:108px;font-size:13px;height: 33px;"
						class="btn btn-warning retry-button" id="payButton" data-order-id="{{this._id}}">
						Retry Payment
					</button>
				</div>
				<div style="width:50%;">
					<form> <button class="btn btn-success" style="width: 134px;"
							onclick="downloadInvoice('{{_id}}')">Download Invoice</button>

					</form>
				</div>
			</div>
		</div>


		<hr>
		</div>
		{{/each}}

	</main>
	<script>
		function downloadInvoice(orderId) {
			window.open(`/download-invoice/${orderId}`, "_blank");
		}
	</script>

	<div class="logo-carousel-section">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<div class="logo-carousel-inner">

						<div class="single-logo-item">
							<img style="margin-top: 50px;"
								src="https://logos-world.net/wp-content/uploads/2020/04/Louis-Vuitton-Logo.png" alt="">
						</div>
						<div class="single-logo-item">
							<img style="margin-top: 10px"
								src="https://parspng.com/wp-content/uploads/2022/10/pumapng.parspng.com_-300x300.png"
								alt="">
						</div>
						<div class="single-logo-item">
							<img style="height:120px;width:120px;margin-top:36px"
								src="https://cdn2.iconfinder.com/data/icons/apple-tv-1/512/apple_logo-512.png" alt="">
						</div>
						<div class="single-logo-item">
							<img style="margin-top: 17px;height:175px"
								src="https://images.samsung.com/is/image/samsung/assets/global/about-us/brand/logo/256_144_2.png?$512_N_PNG$"
								alt="">
						</div>
						<div class="single-logo-item">
							<img style="margin-top: 45px"
								src="https://download.logo.wine/logo/Citizen_Watch/Citizen_Watch-Logo.wine.png" alt="">
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- footer -->
	<div class="footer-area">
		<div class="container">
			<div class="row">
				<div class="col-lg-3 col-md-6">
					<div class="footer-box about-widget">
						<h2 class="widget-title">About us</h2>
						<p>Ut enim ad minim veniam perspiciatis unde omnis iste natus error sit voluptatem accusantium
							doloremque laudantium, totam rem aperiam, eaque ipsa quae.</p>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<div class="footer-box get-in-touch">
						<h2 class="widget-title">Get in Touch</h2>
						<ul>
							<li>34/8, East Hukupara, Gifirtok, Sadan.</li>
							<li>support@fruitkha.com</li>
							<li>+00 111 222 3333</li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<div class="footer-box pages">
						<h2 class="widget-title">Pages</h2>
						<ul>
							<li><a href="index.html">Home</a></li>
							<li><a href="about.html">About</a></li>
							<li><a href="services.html">Shop</a></li>
							<li><a href="news.html">News</a></li>
							<li><a href="contact.html">Contact</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<div class="footer-box subscribe">
						<h2 class="widget-title">Subscribe</h2>
						<p>Subscribe to our mailing list to get the latest updates.</p>
						<form action="index.html">
							<input type="email" placeholder="Email">
							<button type="submit"><i class="fas fa-paper-plane"></i></button>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<!-- end footer -->


	<script>
		document.getElementById("payButton").onclick = async function () {
			const orderId = this.getAttribute("data-order-id"); // Get the order ID from the button's data attribute
			console.log("orderId", orderId)
			try {
				// Send a request to your backend to get the Razorpay order details
				const response = await fetch(`/retry-razorpay/${orderId}`);

				const data = await response.json();

				if (data.success) {
					const razorpayOrder = data.razorpayOrder;
					console.log("razorpayOrder",razorpayOrder)
					const options = {
						key: "rzp_test_27cbwJ6wd0CuiQ",
						amount: razorpayOrder.amount,
						currency: razorpayOrder.currency,
						name: "Watch Premium",
						description: "Order Payment",
						order_id: razorpayOrder.orderId,
						handler: function (response) {
							console.log("Payment successful", response);
							fetch(`/retry-payment-success/${orderId}`, {
								method: "POST",
								headers: {
									"Content-Type": "application/json",
								},
								body: JSON.stringify({
									paymentDetails: response,
									orderId: orderId,
								}),
							});
						},
						prefill: {
							name: "Customer Name", // Use real customer data
							email: "customer@example.com",
							contact: "75 94 060696",
						},
						notes: {
							address: "Customer address", // Use real customer address
						},
						theme: {
							color: "#F37254", // Optional, change as per your design
						},
					};

					// Open the Razorpay checkout window
					const rzp1 = new Razorpay(options);
					rzp1.open(); // Open the Razorpay payment window
				} else {
					alert("Failed to fetch Razorpay details.");
				}
			} catch (error) {
				console.error("Error fetching Razorpay order details", error);
			}
		};
	</script>


	<div id="returnModal" class="modal fade" tabindex="-1" role="dialog">
		<div class="modal-dialog modal-dialog-centered" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Return Confirmation</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<p id="returnMessage">
						Are you sure you want to return this item/order? Please ensure that the item is in its original
						condition,
						with all packaging, labels, and accessories intact. If you have any doubts or questions, feel
						free to reach out
						to our customer support team. Returns are subject to our return policy and may require
						verification of purchase.
						Do you wish to proceed with the return request?
					</p>

					<p id="errorMessage" style="display: none; color: red;">Error processing return. Please try again.
					</p>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
					{{#each orders}}
					{{#each items}}
					<button type="button" class="btn btn-danger" id="confirmReturnBtn" data-order-id="{{this._id}}"
						data-item-id="{{this._id}}" data-toggle="modal" data-target="#returnModal">
						Confirm Return
					</button>
					{{/each}}
					{{/each}}
				</div>
			</div>
		</div>
	</div>

	<script>
		document.addEventListener('DOMContentLoaded', function () {
			const confirmReturnBtn = document.getElementById('confirmReturnBtn');
			const itemId = confirmReturnBtn.getAttribute('data-order-id');

			confirmReturnBtn.addEventListener('click', function () {
				console.log("Button clicked");
				console.log("itemId", itemId);

				fetch(`/return-order/${itemId}`, {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json'
					},
				})
					.then(response => response.json())
					.then(data => {
						console.log(data);
					})
					.catch(error => {
						console.error('Error:', error);
					});
			});
		});
	</script>


	<!-- copyright -->
	<div class="copyright">
		<div class="container">
			<div class="row">
				<div class="col-lg-6 col-md-12">
					<p>Copyrights &copy; 2019 - <a href="https://imransdesign.com/">muhammed uvais</a>, All
						Rights
						Reserved.<br>
						Distributed By - <a href="https://themewagon.com/">nextick.store</a>
					</p>
				</div>
				<div class="col-lg-6 text-right col-md-12">
					<div class="social-icons">
						<ul>
							<li><a href="#" target="_blank"><i class="fab fa-facebook-f"></i></a></li>
							<li><a href="#" target="_blank"><i class="fab fa-twitter"></i></a></li>
							<li><a href="#" target="_blank"><i class="fab fa-instagram"></i></a></li>
							<li><a href="#" target="_blank"><i class="fab fa-linkedin"></i></a></li>
							<li><a href="#" target="_blank"><i class="fab fa-dribbble"></i></a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end copyright -->
	<!-- jquery -->
	<script src="/assets/js/jquery-1.11.3.min.js"></script>
	<!-- bootstrap -->
	<script src="/assets/bootstrap/js/bootstrap.min.js"></script>
	<!-- count down -->
	<script src="/assets/js/jquery.countdown.js"></script>
	<!-- isotope -->
	<script src="/assets/js/jquery.isotope-3.0.6.min.js"></script>
	<!-- waypoints -->
	<script src="/assets/js/waypoints.js"></script>
	<!-- owl carousel -->
	<script src="/assets/js/owl.carousel.min.js"></script>
	<!-- magnific popup -->
	<script src="/assets/js/jquery.magnific-popup.min.js"></script>
	<!-- mean menu -->
	<script src="/assets/js/jquery.meanmenu.min.js"></script>
	<!-- sticker js -->
	<script src="/assets/js/sticker.js"></script>
	<!-- main js -->
	<script src="/assets/js/main.js"></script>
	<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

	<script>
		document.getElementById('confirmCancelBtn').addEventListener('click', function () {
			location.reload();  // Refresh the page
		});
	</script>
	<script>
		// Variables to hold IDs and type of cancel action
		var itemToCancelId = null;
		var orderToCancelId = null;
		var cancelType = null;

		// Set item to cancel (order or item) and store IDs
		function setItemToCancel(orderId, itemId, type) {
			orderToCancelId = orderId;
			itemToCancelId = itemId;
			cancelType = type;
			// Dynamically update the modal text
			document.querySelector("#modalMessage").innerHTML;
		}

		// Confirm cancel action
		document.getElementById('confirmCancelBtn').addEventListener('click', function () {
			let url = '';
			let requestBody = {};

			if (cancelType === 'order') {
				// Cancel entire order
				url = `/orders/${orderToCancelId}`;
				requestBody = { status: 'canceled' };
				location.reload()
			} else if (cancelType === 'item') {
				// Cancel a specific item in the order
				url = `/orders/${orderToCancelId}/items/${itemToCancelId}`;
				requestBody = { status: 'canceled' };
				location.reload()

			}

			// Send PATCH request to update status to "cancelled"
			fetch(url, {
				method: 'PATCH',
				headers: { 'Content-Type': 'application/json' },
				body: JSON.stringify(requestBody),
			})
				.then(response => response.json())
				.then(data => {
					if (data.success) {
						// Refresh the page or update the UI to reflect the cancellation
						window.location.reload();
					} else {
						// Display error message in the modal
						document.getElementById('errorMessage').style.display = 'block';
					}
				})
				.catch(error => {
					console.error('Error updating status:', error);
					document.getElementById('errorMessage').style.display = 'block';
				});
			window.location.reload();
			// Close modal after action
			$('#cancelModal').modal('hide');
		});


	</script>


</body>

</html>